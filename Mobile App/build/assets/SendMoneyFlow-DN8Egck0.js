import{r as i,j as e,b as ae,g as L,t as f,B as h,A as te,e as re,I as k,h as le,i as ne}from"./index-Bqz_yRq7.js";import{L as v}from"./label-4ZnbwNfe.js";import{A as V,b as R,a as B}from"./avatar-BY_DMo7l.js";import{c as ie}from"./index-D6KmJQJ9.js";import{P as G}from"./index-CN_ORhkT.js";import{S as oe,a as ce,b as de,c as me,d as xe}from"./select-rJbz6XPe.js";import{H as E,N as U}from"./index-J6jMrZ_n.js";import{L as he}from"./lock-Di1-02iN.js";import{m as $}from"./proxy-BKIinVtD.js";import"./index-DqE8IFle.js";import"./index-DoY1jJYS.js";import"./index-7dXNdzLe.js";import"./chevron-down-DfTu3T5-.js";var A="Progress",F=100,[ue]=ie(A),[pe,fe]=ue(A),H=i.forwardRef((s,r)=>{const{__scopeProgress:o,value:d=null,max:a,getValueLabel:u=ge,...l}=s;(a||a===0)&&!z(a)&&console.error(be(`${a}`,"Progress"));const m=z(a)?a:F;d!==null&&!O(d,m)&&console.error(ve(`${d}`,"Progress"));const n=O(d,m)?d:null,N=j(n)?u(n,m):void 0;return e.jsx(pe,{scope:o,value:n,max:m,children:e.jsx(G.div,{"aria-valuemax":m,"aria-valuemin":0,"aria-valuenow":j(n)?n:void 0,"aria-valuetext":N,role:"progressbar","data-state":q(n,m),"data-value":n??void 0,"data-max":m,...l,ref:r})})});H.displayName=A;var W="ProgressIndicator",X=i.forwardRef((s,r)=>{const{__scopeProgress:o,...d}=s,a=fe(W,o);return e.jsx(G.div,{"data-state":q(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...d,ref:r})});X.displayName=W;function ge(s,r){return`${Math.round(s/r*100)}%`}function q(s,r){return s==null?"indeterminate":s===r?"complete":"loading"}function j(s){return typeof s=="number"}function z(s){return j(s)&&!isNaN(s)&&s>0}function O(s,r){return j(s)&&!isNaN(s)&&s<=r&&s>=0}function be(s,r){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${r}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${F}\`.`}function ve(s,r){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${r}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${F} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var je=H,Ne=X;function ye({className:s,value:r,...o}){return e.jsx(je,{"data-slot":"progress",className:ae("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...o,children:e.jsx(Ne,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})})}function De({onBack:s,onComplete:r,initialRecipient:o,autoVerify:d}){const[a,u]=i.useState(1),[l,m]=i.useState(typeof o=="string"?o:""),[n,N]=i.useState(""),[K,J]=i.useState("USD"),[y,I]=i.useState(!1),[M,T]=i.useState(!1),[w,S]=i.useState(!1),[C,Q]=i.useState(""),[c,g]=i.useState(null),[we,_]=i.useState(!1),Y=a/3*100;i.useEffect(()=>{typeof o=="string"&&o.length>0&&(m(o),d&&P())},[o,d]);const P=async()=>{if(!l)return null;T(!0),g(null),_(!1),S(!1);try{const t=await L.checkUser(l),x=t?.data||t?.user||t,Z=(x?.f_name||x?.first_name||"").trim(),ee=(x?.l_name||x?.last_name||"").trim(),se=(x?.name||`${Z} ${ee}`.trim()||l).trim();let p=x?.image;p&&typeof p=="string"&&!p.startsWith("http")&&(p=`https://market.bery.in/storage/app/public/profile/${p}`);const D={name:se,phone:x?.phone||x?.email||l,image:p};return g(D),f.success("User verified!"),D}catch(t){return console.error("User check failed",t),_(!0),S(!0),f.info("User not found on server. Please enter name manually."),null}finally{T(!1)}},b=async()=>{if(a===1){let t=c;if(w&&C?(t={name:C,phone:l,image:void 0},g(t)):!t&&!w&&(t=await P()),!t)return;try{E.notification({type:U.Success})}catch{}u(a+1)}else if(a===2){try{E.notification({type:U.Success})}catch{}u(a+1)}else{I(!0);try{await L.transferFund(parseFloat(n),l);try{E.notification({type:U.Success})}catch{}f.success("Transfer Successful!"),r()}catch(t){t.response?.status===404?f.error("Transfer Unavailable",{description:"The Funds Transfer feature is not deployed on this server."}):f.error("Transfer Failed",{description:t.response?.data?.errors?.[0]?.message||"Something went wrong"})}finally{I(!1)}}};return e.jsxs("div",{className:"h-screen overflow-y-auto bg-[#0a0a1a] pb-32",children:[e.jsx("div",{className:"bg-gradient-to-br from-[#0f172a] to-[#1e3a8a] text-white px-5 py-6",children:e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(h,{variant:"ghost",size:"icon",onClick:s,className:"text-white hover:bg-white/20",children:e.jsx(te,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl",style:{fontFamily:"Montserrat, sans-serif"},children:"Send Money"})]})}),e.jsx("div",{className:"px-5 -mt-10 py-6 pb-8",children:e.jsx($.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3},children:e.jsxs(re,{className:"p-5 bg-[#1a1a2e] border-slate-700/40",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(ye,{value:Y,className:"h-2 bg-slate-700"}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-slate-400",children:[e.jsx("span",{className:a>=1?"text-blue-400":"",children:"Recipient"}),e.jsx("span",{className:a>=2?"text-blue-400":"",children:"Amount"}),e.jsx("span",{className:a>=3?"text-blue-400":"",children:"Confirm"})]})]}),a===1&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-lg mb-4 text-white",children:"Recipient Details"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(v,{className:"text-xs text-slate-300",children:"Email or Phone"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{value:l,onChange:t=>{m(t.target.value),g(null),S(!1)},onKeyDown:t=>t.key==="Enter"&&b(),placeholder:"Enter email or phone number",className:"mt-2 bg-[#0a0a1a] border-slate-700/40 text-white placeholder:text-slate-400/60 flex-1"}),e.jsx(h,{onClick:P,disabled:M||!l,className:"mt-2 bg-blue-600 hover:bg-blue-700",size:"icon",children:M?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):e.jsx(le,{className:"w-4 h-4"})})]}),w&&e.jsxs($.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-4",children:[e.jsx(v,{className:"text-xs text-yellow-500",children:"Recipient Name (Required)"}),e.jsx(k,{value:C,onChange:t=>Q(t.target.value),placeholder:"Enter recipient's name",className:"mt-2 bg-[#0a0a1a] border-yellow-500/50 text-white placeholder:text-slate-400/60",autoFocus:!0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"We couldn't find this user. Please enter their name to continue."})]}),c&&e.jsxs($.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4 p-3 bg-blue-900/20 border border-blue-500/30 rounded-xl flex items-center gap-3",children:[e.jsxs(V,{className:"w-10 h-10 border border-white/10",children:[e.jsx(R,{src:c?.image||void 0}),e.jsx(B,{className:"bg-blue-600 text-white",children:String(c?.name||"").substring(0,2).toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:String(c?.name||l)}),e.jsx("p",{className:"text-xs text-blue-200/70",children:String(c?.phone||l)})]}),e.jsx(ne,{className:"w-5 h-5 text-green-400 ml-auto"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Enter the registered email or phone number of the user you want to send money to."})]})}),e.jsx(h,{onClick:b,disabled:!l,className:"w-full mt-6 bg-gradient-to-r from-[#0f172a] to-[#1e3a8a] h-12",children:"Continue"})]}),a===2&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-lg mb-6 text-white",children:"Enter Amount"}),e.jsxs("div",{className:"mb-5",children:[e.jsx(v,{className:"text-xs text-slate-300",children:"Currency"}),e.jsxs(oe,{value:K,onValueChange:J,children:[e.jsx(ce,{className:"mt-2 h-12 bg-[#0a0a1a] border-slate-700/40 text-white",children:e.jsx(de,{})}),e.jsx(me,{className:"bg-[#1a1a2e] border-slate-700/40",children:e.jsx(xe,{value:"USD",children:"ðŸ‡ºðŸ‡¸ USD - US Dollar"})})]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx(v,{className:"text-xs text-slate-300",children:"Amount"}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-2xl text-slate-400/80",children:"$"}),e.jsx(k,{type:"number",value:n,onChange:t=>N(t.target.value),placeholder:"0.00",className:"pl-12 text-3xl h-20 border-2 border-slate-700/40 focus:border-blue-600 bg-[#0a0a1a] text-white placeholder:text-slate-400/60"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(h,{onClick:()=>u(1),variant:"outline",className:"flex-1 h-12 border-slate-700/40 text-slate-300 hover:bg-slate-700/30",children:"Back"}),e.jsx(h,{onClick:b,disabled:!n||parseFloat(n)<=0,className:"flex-1 bg-gradient-to-r from-[#0f172a] to-[#1e3a8a] h-12",children:"Continue"})]})]}),a===3&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-[#0f172a] to-[#1e3a8a] mx-auto mb-4 flex items-center justify-center shadow-lg shadow-blue-600/30",children:e.jsx(he,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-lg mb-2 text-white",children:"Confirm Transaction"})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[c&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-[#0a0a1a] rounded-xl border border-slate-700/40",children:[e.jsxs(V,{className:"w-10 h-10 border border-white/10",children:[e.jsx(R,{src:c?.image||void 0}),e.jsx(B,{className:"bg-blue-600 text-white",children:String(c?.name||l).substring(0,2).toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-slate-400/80",children:"Sending to"}),e.jsx("p",{className:"text-sm text-white font-medium",children:String(c?.name||l)}),e.jsx("p",{className:"text-xs text-slate-500",children:String(c?.phone||l)})]})]}),e.jsxs("div",{className:"p-4 bg-[#0a0a1a] rounded-xl border border-slate-700/40",children:[e.jsx("p",{className:"text-xs text-slate-400/80 mb-1",children:"Amount"}),e.jsxs("p",{className:"text-3xl text-white",children:["$",n]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-4 bg-[#0a0a1a] rounded-xl border border-slate-700/40",children:[e.jsx("p",{className:"text-xs text-slate-400/80 mb-1",children:"Fee"}),e.jsx("p",{className:"text-sm text-white",children:"Free"})]}),e.jsxs("div",{className:"p-4 bg-[#0a0a1a] rounded-xl border border-slate-700/40",children:[e.jsx("p",{className:"text-xs text-slate-400/80 mb-1",children:"Total"}),e.jsxs("p",{className:"text-sm text-white",children:["$",n]})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(h,{onClick:()=>u(2),variant:"outline",className:"flex-1 h-12 border-slate-700/40 text-slate-300 hover:bg-slate-700/30",disabled:y,children:"Back"}),e.jsx(h,{onClick:b,disabled:y,className:"flex-1 bg-gradient-to-r from-[#0f172a] to-[#1e3a8a] h-12",children:y?"Sending...":"Confirm & Send"})]})]})]})},a)})]})}export{De as SendMoneyFlow};
