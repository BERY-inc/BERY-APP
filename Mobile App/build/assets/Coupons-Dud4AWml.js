import{d as _,r as t,j as e,B as d,A as F,h as T,e as l}from"./index-Bqz_yRq7.js";import{p as h}from"./pauketService-B_zzwgIj.js";import{T as i}from"./tag-DNwfAcxO.js";import{C as A}from"./calendar-CXle9qXn.js";import{m as u}from"./proxy-BKIinVtD.js";function R({onBack:g,onNavigate:M,userId:p,userName:E,userImage:I}){const b=_(),[n,o]=t.useState("categories"),[x,f]=t.useState([]),[c,j]=t.useState([]),[N,a]=t.useState(!0),[m,r]=t.useState(null),[y,v]=t.useState("");t.useEffect(()=>{w()},[]);const w=async()=>{try{a(!0),r(null);const s=await h.getCategoryList();f(s)}catch(s){console.error("Failed to fetch categories:",s),r("Failed to load categories. Please try again.")}finally{a(!1)}},C=async()=>{try{a(!0),r(null);const{coupons:s}=await h.getMyCoupons(p,"all");j(s)}catch(s){console.error("Failed to fetch coupons:",s),r("Failed to load your coupons. Please try again.")}finally{a(!1)}},S=s=>{b(`/coupon-campaigns?categoryId=${s}`)},k=()=>{o("myCoupons"),c.length===0&&C()};return e.jsxs("div",{className:"h-screen overflow-y-auto bg-[#0a0a1a] pb-32",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#0f172a] to-[#1e3a8a] text-white px-5 pt-14 pb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:g,className:"text-white hover:bg-white/20 rounded-full",children:e.jsx(F,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl",style:{fontFamily:"Inter, sans-serif",fontWeight:700},children:"Coupons & Offers"})]}),e.jsx("p",{className:"text-blue-200/80 text-sm",children:"Discover amazing deals and discounts"})]}),e.jsx("div",{className:"px-5 py-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search for coupons, merchants...",className:"w-full pl-10 pr-4 py-3 bg-[#1a1a2e] border border-slate-700/50 rounded-xl text-white placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50",value:y,onChange:s=>v(s.target.value)})]})}),e.jsx("div",{className:"px-5 mb-4",children:e.jsxs("div",{className:"flex bg-[#1a1a2e] rounded-xl p-1",children:[e.jsx("button",{className:`flex-1 py-2 px-4 rounded-lg text-sm transition-colors ${n==="categories"?"bg-blue-600 text-white":"text-slate-400 hover:text-white"}`,onClick:()=>o("categories"),children:"Categories"}),e.jsx("button",{className:`flex-1 py-2 px-4 rounded-lg text-sm transition-colors ${n==="myCoupons"?"bg-blue-600 text-white":"text-slate-400 hover:text-white"}`,onClick:k,children:"My Coupons"})]})}),e.jsxs("div",{className:"px-5",children:[m&&e.jsx("div",{className:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-xl text-red-200 text-sm",children:m}),N?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):n==="categories"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-white text-lg mb-4",style:{fontFamily:"Inter, sans-serif",fontWeight:600},children:"Browse by Category"}),x.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-4",children:x.map(s=>e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsx(l,{className:"p-4 bg-[#1a1a2e] border border-slate-700/40 hover:border-blue-500/50 cursor-pointer transition-all",onClick:()=>S(s.id),children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[s.image?e.jsx("img",{src:s.image,alt:s.name,className:"w-16 h-16 rounded-lg object-cover mb-3"}):e.jsx("div",{className:"w-16 h-16 rounded-lg bg-blue-500/20 flex items-center justify-center mb-3",children:e.jsx(i,{className:"w-8 h-8 text-blue-400"})}),e.jsx("h3",{className:"text-white text-sm font-medium mb-1",children:s.name}),e.jsxs("p",{className:"text-slate-400 text-xs",children:[s.campaign_count," offers"]})]})})},s.id))}):e.jsxs(l,{className:"p-8 bg-[#1a1a2e] border border-slate-700/40 text-center",children:[e.jsx(i,{className:"w-12 h-12 text-slate-500 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-400",children:"No categories available at the moment"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-white text-lg mb-4",style:{fontFamily:"Inter, sans-serif",fontWeight:600},children:"My Coupons"}),c.length>0?e.jsx("div",{className:"space-y-4",children:c.map(s=>e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(l,{className:"p-4 bg-[#1a1a2e] border border-slate-700/40",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[s.qr_code?e.jsx("div",{className:"w-16 h-16 rounded-lg bg-white p-1 flex items-center justify-center",children:e.jsx("img",{src:s.qr_code,alt:"Coupon QR Code",className:"w-full h-full object-contain"})}):e.jsx("div",{className:"w-16 h-16 rounded-lg bg-blue-500/20 flex items-center justify-center",children:e.jsx(i,{className:"w-8 h-8 text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-white text-sm font-medium truncate",children:s.merchant_name}),e.jsx("p",{className:"text-slate-300 text-xs mb-1 truncate",children:s.campaign_name}),e.jsx("p",{className:"text-emerald-400 text-xs font-medium mb-2",children:s.offer_to_show}),e.jsxs("div",{className:"flex items-center gap-3 text-slate-400 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"w-3 h-3"}),e.jsxs("span",{children:["Expires ",new Date(s.expiry_date).toLocaleDateString()]})]}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-700/50 rounded text-xs capitalize",children:s.coupon_status})]})]})]}),s.isCTAvalid&&e.jsx(d,{className:"w-full mt-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-xs py-2",onClick:()=>{s.CTAredirect&&window.open(s.CTAredirect,"_blank")},children:s.CTAname||"Redeem Now"})]})},s.id))}):e.jsxs(l,{className:"p-8 bg-[#1a1a2e] border border-slate-700/40 text-center",children:[e.jsx(i,{className:"w-12 h-12 text-slate-500 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-400",children:"You don't have any coupons yet"}),e.jsx(d,{className:"mt-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm py-2",onClick:()=>o("categories"),children:"Browse Coupons"})]})]})]})]})}export{R as Coupons};
