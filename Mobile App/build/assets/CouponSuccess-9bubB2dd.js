import{c as P,d as Q,w as U,r as s,j as e,B as r,A as f,e as o}from"./index-BKXw_VyK.js";import{Q as V}from"./index-C9Gsf_Pd.js";import{p as B}from"./pauketService-cZHMaSeV.js";import{C as q}from"./copy-nrXT9ebk.js";import{E as D}from"./external-link-Bq-ZZbxT.js";import"./index-Chjiymov.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],p=P("circle-check-big",W);function se({onBack:l,onNavigate:Y,userId:j}){const b=Q(),N=U(),[a,g]=s.useState([]),[x,v]=s.useState(""),[w,C]=s.useState(""),[H,y]=s.useState(""),[c,k]=s.useState(""),[S,L]=s.useState(!1),[A,R]=s.useState(""),[n,T]=s.useState(""),[E,d]=s.useState(!0),[h,m]=s.useState(null),[_,u]=s.useState(!1),i=new URLSearchParams(N.search).get("sourceLink");s.useEffect(()=>{i?z(i):(m("No coupon specified"),d(!1))},[i]);const z=async I=>{try{d(!0),m(null);const t=await B.activateCoupon(I,j);g(t.coupons),v(t.merchantLogo),C(t.offer),y(t.redirectUrl),k(t.couponCode),L(t.isCTAValid),R(t.CTAName),T(t.CTARedirect)}catch(t){console.error("Failed to activate coupon:",t),m("Failed to activate coupon. Please try again.")}finally{d(!1)}},M=()=>{c&&(navigator.clipboard.writeText(c),u(!0),setTimeout(()=>u(!1),2e3))},O=()=>{n&&window.open(n,"_blank")},F=()=>{b("/my-coupons")};return i?e.jsxs("div",{className:"h-screen overflow-y-auto bg-[#0a0a1a] pb-32",children:[e.jsx("div",{className:"bg-gradient-to-br from-[#0f172a] to-[#1e3a8a] text-white px-5 pt-14 pb-6",children:e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:l,className:"text-white hover:bg-white/20 rounded-full",children:e.jsx(f,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl",style:{fontFamily:"Inter, sans-serif",fontWeight:700},children:"Offer Activated"})]})}),e.jsxs("div",{className:"px-5",children:[h&&e.jsx("div",{className:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-xl text-red-200 text-sm",children:h}),E?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(o,{className:"p-6 bg-[#1a1a2e] border border-slate-700/40 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-emerald-500/20 flex items-center justify-center",children:e.jsx(p,{className:"w-10 h-10 text-emerald-500"})})}),e.jsx("h2",{className:"text-white text-xl font-medium mb-2",children:"Offer Activated!"}),e.jsx("p",{className:"text-slate-300 text-sm",children:"Your offer is now ready to use"})]}),x&&e.jsx(o,{className:"p-4 bg-[#1a1a2e] border border-slate-700/40",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:x,alt:"Merchant",className:"w-12 h-12 rounded-lg object-cover"}),e.jsx("div",{children:e.jsx("h3",{className:"text-white text-sm font-medium",children:w})})]})}),c&&e.jsxs(o,{className:"p-4 bg-[#1a1a2e] border border-slate-700/40",children:[e.jsx("h3",{className:"text-white text-sm font-medium mb-3",children:"Your Coupon Code"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-slate-800/50 rounded-lg p-3",children:e.jsx("p",{className:"text-white font-mono text-center",children:c})}),e.jsx(r,{variant:"ghost",size:"icon",onClick:M,className:"text-slate-400 hover:text-white hover:bg-slate-700/50",children:_?e.jsx(p,{className:"w-5 h-5 text-emerald-500"}):e.jsx(q,{className:"w-5 h-5"})})]})]}),a.length>0&&a[0].qr_code&&e.jsxs(o,{className:"p-4 bg-[#1a1a2e] border border-slate-700/40",children:[e.jsx("h3",{className:"text-white text-sm font-medium mb-3",children:"QR Code"}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"p-3 bg-white rounded-lg",children:e.jsx(V,{value:a[0].qr_code,size:128,level:"H",viewBox:"0 0 256 256"})})}),e.jsx("p",{className:"text-slate-400 text-xs text-center mt-2",children:"Show this QR code at checkout"})]}),a.length>0&&a[0].expiry_date&&e.jsx(o,{className:"p-4 bg-[#1a1a2e] border border-slate-700/40",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Expires on"}),e.jsx("span",{className:"text-white text-sm font-medium",children:new Date(a[0].expiry_date).toLocaleDateString()})]})}),S&&n&&e.jsxs(r,{className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-3 text-base font-medium flex items-center justify-center gap-2",onClick:O,children:[A||"Redeem Now",e.jsx(D,{className:"w-4 h-4"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(r,{variant:"outline",className:"flex-1 bg-[#1a1a2e] border-slate-700/50 text-white",onClick:l,children:"Back to Offers"}),e.jsx(r,{className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white",onClick:F,children:"My Coupons"})]})]})]})]}):e.jsxs("div",{className:"h-screen overflow-y-auto bg-[#0a0a1a] pb-32",children:[e.jsx("div",{className:"bg-gradient-to-br from-[#0f172a] to-[#1e3a8a] text-white px-5 pt-14 pb-6",children:e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:l,className:"text-white hover:bg-white/20 rounded-full",children:e.jsx(f,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl",style:{fontFamily:"Inter, sans-serif",fontWeight:700},children:"Activate Offer"})]})}),e.jsx("div",{className:"px-5 py-8",children:e.jsx(o,{className:"p-8 bg-[#1a1a2e] border border-slate-700/40 text-center",children:e.jsx("p",{className:"text-slate-400",children:"No coupon specified"})})})]})}export{se as CouponSuccess};
