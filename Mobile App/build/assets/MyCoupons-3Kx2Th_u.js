import{r as s,j as e,B as l,A as P,e as f}from"./index-BKXw_VyK.js";import{Q as E}from"./index-C9Gsf_Pd.js";import{p as z}from"./pauketService-cZHMaSeV.js";import{T as b}from"./tag-B0Z7eOpr.js";import{C as F}from"./calendar-C6-v8Mof.js";import{C as g}from"./copy-nrXT9ebk.js";import{E as M}from"./external-link-Bq-ZZbxT.js";import{m as L}from"./proxy-BXaEAfrz.js";import"./index-Chjiymov.js";function V({onBack:j,onNavigate:B,userId:N}){const[c,v]=s.useState([]),[w,d]=s.useState(!0),[x,m]=s.useState(null),[a,h]=s.useState("all"),[r,o]=s.useState(1),[p,C]=s.useState(0),[i,y]=s.useState(0),[_,u]=s.useState(null);s.useEffect(()=>{k()},[a,r]);const k=async()=>{try{d(!0),m(null);const{coupons:t,totalCount:n,totalPages:S}=await z.getMyCoupons(N,a,r);v(t),C(n),y(S)}catch(t){console.error("Failed to fetch coupons:",t),m("Failed to load your coupons. Please try again.")}finally{d(!1)}},T=(t,n)=>{navigator.clipboard.writeText(t),u(n),setTimeout(()=>u(null),2e3)},A=t=>{t&&window.open(t,"_blank")};return e.jsxs("div",{className:"h-screen overflow-y-auto bg-[#0a0a1a] pb-32",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#0f172a] to-[#1e3a8a] text-white px-5 pt-14 pb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:j,className:"text-white hover:bg-white/20 rounded-full",children:e.jsx(P,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl",style:{fontFamily:"Inter, sans-serif",fontWeight:700},children:"My Coupons"})]}),e.jsx("p",{className:"text-blue-200/80 text-sm",children:p>0?`${p} coupons`:"Your saved offers"})]}),e.jsx("div",{className:"px-5 py-4",children:e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:["all","activated","claimed","expired"].map(t=>e.jsx("button",{className:`px-4 py-2 rounded-full text-xs whitespace-nowrap transition-colors ${a===t?"bg-blue-600 text-white":"bg-[#1a1a2e] text-slate-400 hover:text-white"}`,onClick:()=>{h(t),o(1)},children:t.charAt(0).toUpperCase()+t.slice(1)},t))})}),e.jsxs("div",{className:"px-5",children:[x&&e.jsx("div",{className:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-xl text-red-200 text-sm",children:x}),w?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):c.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4 mb-6",children:c.map(t=>e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(f,{className:"p-4 bg-[#1a1a2e] border border-slate-700/40",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[t.qr_code?e.jsx("div",{className:"w-16 h-16 rounded-lg bg-white p-1 flex items-center justify-center",children:e.jsx(E,{value:t.qr_code,size:48,level:"H",viewBox:"0 0 256 256"})}):e.jsx("div",{className:"w-16 h-16 rounded-lg bg-blue-500/20 flex items-center justify-center",children:e.jsx(b,{className:"w-8 h-8 text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-white text-sm font-medium truncate",children:t.merchant_name}),e.jsx("p",{className:"text-slate-300 text-xs mb-1 truncate",children:t.campaign_name}),e.jsx("p",{className:"text-emerald-400 text-xs font-medium mb-2",children:t.offer_to_show}),e.jsxs("div",{className:"flex items-center gap-3 text-slate-400 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),e.jsxs("span",{children:["Expires ",new Date(t.expiry_date).toLocaleDateString()]})]}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-700/50 rounded text-xs capitalize",children:t.coupon_status})]})]})]}),t.coupon_code&&e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"flex-1 bg-slate-800/50 rounded-lg p-2",children:e.jsx("p",{className:"text-white font-mono text-xs text-center truncate",children:t.coupon_code})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>T(t.coupon_code,t.id),className:"text-slate-400 hover:text-white hover:bg-slate-700/50",children:_===t.id?e.jsx(g,{className:"w-4 h-4 text-emerald-500"}):e.jsx(g,{className:"w-4 h-4"})})]}),t.isCTAvalid&&t.CTAredirect&&e.jsxs(l,{className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-xs py-2 flex items-center justify-center gap-1",onClick:()=>A(t.CTAredirect),children:[t.CTAname||"Redeem Now",e.jsx(M,{className:"w-3 h-3"})]})]})},t.id))}),i>1&&e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>o(t=>Math.max(t-1,1)),disabled:r===1,className:"bg-[#1a1a2e] border-slate-700/50 text-white",children:"Previous"}),e.jsxs("span",{className:"text-slate-400 text-sm",children:["Page ",r," of ",i]}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>o(t=>Math.min(t+1,i)),disabled:r===i,className:"bg-[#1a1a2e] border-slate-700/50 text-white",children:"Next"})]})]}):e.jsxs(f,{className:"p-8 bg-[#1a1a2e] border border-slate-700/40 text-center",children:[e.jsx(b,{className:"w-12 h-12 text-slate-500 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-400",children:a==="all"?"You don't have any coupons yet":`No ${a} coupons found`}),a!=="all"&&e.jsx(l,{className:"mt-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm py-2",onClick:()=>h("all"),children:"View All Coupons"})]})]})]})}export{V as MyCoupons};
