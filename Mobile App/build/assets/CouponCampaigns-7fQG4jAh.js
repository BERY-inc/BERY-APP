import{d as F,w as I,r as s,j as e,B as l,A as E,h as z,e as f}from"./index-BKXw_VyK.js";import{p as A}from"./pauketService-cZHMaSeV.js";import{T as b}from"./tag-B0Z7eOpr.js";import{C as R}from"./calendar-C6-v8Mof.js";import{m as T}from"./proxy-BXaEAfrz.js";function G({onBack:j,onNavigate:D,userId:v}){const d=F(),N=I(),[m,y]=s.useState([]),[w,x]=s.useState(!0),[h,i]=s.useState(null),[o,u]=s.useState(""),[a,p]=s.useState(1),[g,C]=s.useState(0),[n,P]=s.useState(0),c=new URLSearchParams(N.search).get("categoryId")||void 0;s.useEffect(()=>{S()},[c,o,a]);const S=async()=>{try{x(!0),i(null);const{campaigns:t,totalCount:r,totalPages:L}=await A.getCampaigns({search:o||void 0,categoryId:c,custId:v,page:a});y(t),C(r),P(L)}catch(t){console.error("Failed to fetch campaigns:",t),i("Failed to load campaigns. Please try again.")}finally{x(!1)}},k=t=>{d(`/coupon-details?sourceLink=${encodeURIComponent(t)}`)},_=async t=>{try{d(`/coupon-activate?sourceLink=${encodeURIComponent(t)}`)}catch(r){console.error("Failed to activate coupon:",r),i("Failed to activate coupon. Please try again.")}};return e.jsxs("div",{className:"h-screen overflow-y-auto bg-[#0a0a1a] pb-32",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#0f172a] to-[#1e3a8a] text-white px-5 pt-14 pb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:j,className:"text-white hover:bg-white/20 rounded-full",children:e.jsx(E,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl",style:{fontFamily:"Inter, sans-serif",fontWeight:700},children:c?"Category Offers":"All Offers"})]}),e.jsx("p",{className:"text-blue-200/80 text-sm",children:g>0?`${g} offers available`:"Discover amazing deals"})]}),e.jsx("div",{className:"px-5 py-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search offers...",className:"w-full pl-10 pr-4 py-3 bg-[#1a1a2e] border border-slate-700/50 rounded-xl text-white placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50",value:o,onChange:t=>u(t.target.value)})]})}),e.jsxs("div",{className:"px-5",children:[h&&e.jsx("div",{className:"mb-4 p-4 bg-red-500/20 border border-red-500/30 rounded-xl text-red-200 text-sm",children:h}),w?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):m.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4 mb-6",children:m.map(t=>e.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(f,{className:"p-4 bg-[#1a1a2e] border border-slate-700/40 hover:border-blue-500/50 cursor-pointer transition-all",onClick:()=>k(t.source_link),children:[e.jsxs("div",{className:"flex gap-3",children:[t.thumbnail?e.jsx("img",{src:t.thumbnail,alt:t.campaign_name,className:"w-16 h-16 rounded-lg object-cover"}):e.jsx("div",{className:"w-16 h-16 rounded-lg bg-blue-500/20 flex items-center justify-center",children:e.jsx(b,{className:"w-8 h-8 text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-white text-sm font-medium mb-1 truncate",children:t.campaign_name}),e.jsx("p",{className:"text-slate-300 text-xs mb-1 truncate",children:t.merchant_name}),e.jsx("p",{className:"text-emerald-400 text-xs font-medium mb-2",children:t.offer_to_show}),e.jsxs("div",{className:"flex items-center gap-3 text-slate-400 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"}),e.jsxs("span",{children:["Expires ",new Date(t.expiry_date).toLocaleDateString()]})]}),t.category_name&&e.jsx("span",{className:"px-2 py-0.5 bg-slate-700/50 rounded text-xs",children:t.category_name})]})]})]}),e.jsx(l,{className:"w-full mt-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-xs py-2",onClick:r=>{r.stopPropagation(),_(t.source_link)},children:"Get Offer"})]})},t.id))}),n>1&&e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>p(t=>Math.max(t-1,1)),disabled:a===1,className:"bg-[#1a1a2e] border-slate-700/50 text-white",children:"Previous"}),e.jsxs("span",{className:"text-slate-400 text-sm",children:["Page ",a," of ",n]}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>p(t=>Math.min(t+1,n)),disabled:a===n,className:"bg-[#1a1a2e] border-slate-700/50 text-white",children:"Next"})]})]}):e.jsxs(f,{className:"p-8 bg-[#1a1a2e] border border-slate-700/40 text-center",children:[e.jsx(b,{className:"w-12 h-12 text-slate-500 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-400",children:"No offers found"}),o&&e.jsx(l,{className:"mt-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm py-2",onClick:()=>u(""),children:"Clear Search"})]})]})]})}export{G as CouponCampaigns};
